const path = require('path');
const fs = require('fs-extra');
const os = require('os');

module.exports = (src, targetBrowser) => {
  let fileContent = fs.readFileSync(src, 'utf-8');
  if(Array.isArray(targetBrowser.intercepted_resource_types)) {
    let extendedTypesText = '';
    targetBrowser.intercepted_resource_types.forEach((extendedType, index, array) => {
      extendedTypesText += `  '${extendedType}',`;
      if(index !== array.length-1) {
        extendedTypesText += os.EOL;
      }
    });
    fileContent = fileContent.replace(/  \/\* <auto-generated-content> \*\//, extendedTypesText);
  } else {
    fileContent = fileContent.replace('<auto-generated-content>', '<nothing-to-add>');
  }
  return fileContent;
};
